{
  "name": "Command",
  "type": "spell",
  "img": "systems/dnd5e/icons/spells/explosion-magenta-1.jpg",
  "data": {
    "description": {
      "value": "<p>You speak a one-word command to a creature you can see within range. The target must succeed on a Wisdom saving throw or follow the command on its next turn. The spell has no effect if the target is undead, if it doesn't understand your language, or if your command is directly harmful to it.</p>\n<p>Some typical commands and their effects follow. You might issue a command other than one described here. If you do so, the GM determines how the target behaves. If the target can't follow your command, the spell ends.</p>\n<p><strong>Approach.</strong> The target moves toward you by the shortest and most direct route, ending its turn if it moves within 5 feet of you.</p>\n<p><strong>Drop.</strong> The target drops whatever it is holding and then ends its turn.</p>\n<p><strong>Flee.</strong> The target spends its turn moving away from you by the fastest available means.</p>\n<p><strong>Grovel.</strong> The target falls @Compendium[dnd5e.rules.Prone]{prone} and then ends its turn.</p>\n<p><strong>Halt.</strong> The target doesn't move and takes no actions. A flying creature stays aloft, provided that it is able to do so. If it must move to stay aloft, it flies the minimum distance needed to remain in the air.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, you can affect one additional creature for each slot level above 1st. The creatures must be within 30 feet of each other when you target them.</p>",
      "chat": "",
      "unidentified": ""
    },
    "source": "Basic Rules, Player's Handbook pg 223",
    "activation": {
      "type": "action",
      "cost": 1,
      "condition": ""
    },
    "duration": {
      "value": 1,
      "units": "round"
    },
    "target": {
      "value": 1,
      "width": null,
      "units": "",
      "type": "creature"
    },
    "range": {
      "value": 60,
      "long": null,
      "units": "ft"
    },
    "uses": {
      "value": null,
      "max": "",
      "per": ""
    },
    "consume": {
      "type": "",
      "target": "",
      "amount": null
    },
    "ability": "",
    "actionType": "save",
    "attackBonus": 0,
    "chatFlavor": "",
    "critical": {
      "threshold": null,
      "damage": ""
    },
    "damage": {
      "parts": [],
      "versatile": ""
    },
    "formula": "",
    "save": {
      "ability": "wis",
      "dc": null,
      "scaling": "spell"
    },
    "level": 1,
    "school": "enc",
    "components": {
      "value": "",
      "vocal": true,
      "somatic": false,
      "material": false,
      "ritual": false,
      "concentration": false
    },
    "materials": {
      "value": "",
      "consumed": false,
      "cost": 0,
      "supply": 0
    },
    "preparation": {
      "mode": "prepared",
      "prepared": false
    },
    "scaling": {
      "mode": "none",
      "formula": ""
    },
    "attunement": 0
  },
  "effects": [],
  "flags": {
    "ddbimporter": {
      "id": 136231,
      "definitionId": 2032,
      "entityTypeId": 435869154,
      "dndbeyond": {
        "lookup": "generic",
        "lookupName": "generic",
        "level": null,
        "castAtLevel": null
      },
      "originalName": "Command",
      "sources": [
        {
          "sourceId": 1,
          "pageNumber": null,
          "sourceType": 2
        },
        {
          "sourceId": 2,
          "pageNumber": 223,
          "sourceType": 1
        }
      ],
      "tags": [
        "Control"
      ],
      "version": "2.9.59",
      "effectsApplied": true
    },
    "betterRolls5e": {
      "quickVersatile": {
        "altValue": true
      },
      "quickCharges": {
        "value": {
          "use": true,
          "resource": true
        },
        "altValue": {
          "use": true,
          "resource": true
        }
      }
    },
    "dae": {
      "activeEquipped": false,
      "alwaysActive": false
    },
    "midi-qol": {
      "onUseMacroName": "[postActiveEffects]ItemMacro",
      "effectActivation": false,
      "forceCEOff": false,
      "forceCEOn": false
    },
    "core": {
      "sourceId": "Compendium.world.ddb-spells.gBlZzWPM6vzWpqdT"
    },
    "rest-recovery": {
      "data": {
        "recovery": {
          "enabled": false
        }
      }
    },
    "midiProperties": {
      "nodam": false,
      "fulldam": false,
      "halfdam": false,
      "rollOther": false,
      "critOther": false,
      "magicdam": false,
      "magiceffect": false,
      "concentration": false,
      "toggleEffect": false
    },
    "itemacro": {
      "macro": {
        "data": {
          "_id": null,
          "name": "Command",
          "type": "script",
          "author": "otqBqyqMuTGDffTr",
          "img": "icons/svg/dice-target.svg",
          "scope": "global",
          "command": "// command\n\nif (args[0].tag === \"OnUse\" && args[0].failedSaves.length > 0) {\n\n\tlet target = canvas.tokens.get(args[0].hitTargets[0].id ?? args[0].hitTargets[0]._id);\n    if (!target) MidiQOL.error(\"No target for Command found\");\n\tlet targetActor = args[0].hitTargets[0].actor ?? args[0].hitTargets[0]._actor;\n\n\tlet dialog = new Promise((resolve, reject) => {\n\t\tnew Dialog({\n\t\ttitle: \"Command: Usage Configuration\",\n\t\tcontent: `\n\t\t<form id=\"command-use-form\">\n\t\t\t<p>` + game.i18n.format(\"DND5E.AbilityUseHint\", {name: \"Command\", type: \"feature\"}) + `</p>\n\t\t\t<p>Choose a command word.</p>\n\t\t\t<form>\n\t\t\t\t<input id=\"command\" type=\"text\" \n\t\t\t\tpattern=\"^[a-zA-Z]+$\"/>\n\t\t\t</form>\n\t\t</form>\n\t\t`,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Command\",\n\t\t\t\tcallback: () => resolve(document.getElementById('command').value)\n\t\t\t},\n\t\t\ttwo: {\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\n\t\t\t\tlabel: \"Cancel\",\n\t\t\t\tcallback: () => {resolve(false)}\n\t\t\t}\n\t\t},\n\t\tdefault: \"two\",\n\t\tclose: callBack => {resolve(false)}\n\t\t}).render(true);\n\t});\n\tcommandWord = await dialog;\n\t\n\tconst effectData = {\n\t\tchanges: [\n\t\t\t{\n\t\t\t\tkey: \"flags.midi-qol.CommandWord\",\n\t\t\t\tmode: CONST.ACTIVE_EFFECT_MODES.CUSTOM,\n\t\t\t\tvalue: commandWord,\n\t\t\t\tpriority: 20,\n\t\t\t}\n\t\t],\n\t\tdisabled: false,\n\t\tduration: { rounds: 1, turns: 1, startTime: game.time.worldTime },\n\t\tflags: { dae: { specialDuration: [\"turnEnd\"] } },\n\t\ticon: args[0].item.img,\n\t\tlabel: `${args[0].item.name}`,\n\t};\n\tawait MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor.uuid, effects: [effectData] });\n}",
          "folder": null,
          "sort": 0,
          "permission": {
            "default": 0
          },
          "flags": {}
        },
        "_id": null,
        "name": "Command",
        "type": "script",
        "author": "ckiTPzlaPztdkjV6",
        "img": "icons/svg/dice-target.svg",
        "scope": "global",
        "command": "// command\n\nconst lastArg = args[args.length - 1];\n\nif (args[0].tag === \"OnUse\" && args[0].failedSaveUuids.length > 0) {\n\n\tconst tokenOrActorTarget = await fromUuid(lastArg.failedSaveUuids[0]);\n    const tactorTarget = tokenOrActorTarget.actor ? tokenOrActorTarget.actor : tokenOrActorTarget;\n    if (!tactorTarget) MidiQOL.error(\"No target for Command found\");\n\n\tlet dialog = new Promise((resolve, reject) => {\n\t\tnew Dialog({\n\t\ttitle: \"Command: Usage Configuration\",\n\t\tcontent: `\n\t\t<form id=\"command-use-form\">\n\t\t\t<p>` + game.i18n.format(\"DND5E.AbilityUseHint\", {name: \"Command\", type: \"feature\"}) + `</p>\n\t\t\t<p>Choose a command word.</p>\n\t\t\t<form>\n\t\t\t\t<input id=\"command\" type=\"text\" \n\t\t\t\tpattern=\"^[a-zA-Z]+$\"/>\n\t\t\t</form>\n\t\t</form>\n\t\t`,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Command\",\n\t\t\t\tcallback: () => resolve(document.getElementById('command').value)\n\t\t\t},\n\t\t\ttwo: {\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\n\t\t\t\tlabel: \"Cancel\",\n\t\t\t\tcallback: () => {resolve(false)}\n\t\t\t}\n\t\t},\n\t\tdefault: \"two\",\n\t\tclose: callBack => {resolve(false)}\n\t\t}).render(true);\n\t});\n\tcommandWord = await dialog;\n\t\n\tconst item = await fromUuid(lastArg.uuid);\n\tconst effectData = {\n\t\tchanges: [\n\t\t\t{ key: \"flags.midi-qol.commandWord\", mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, value: commandWord, priority: 20 },\n\t\t\t{ key: `macro.itemMacro.GM`, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, value: \"\", priority: 20 },\n\t\t],\n\t\tdisabled: false,\n\t\tflags: { dae: { itemData: item.data, specialDuration: [\"turnEnd\"], macroRepeat: \"startEveryTurn\" }, core: { statusId: \"Command\" } },\n\t\ticon: lastArg.item.img,\n\t\tlabel: `${lastArg.item.name}`,\n\t};\n\tawait MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: tactorTarget.uuid, effects: [effectData] });\n}\n\nif (args[0] === \"each\") {\n\tconst tokenOrActor = await fromUuid(lastArg.tokenUuid);\n\tconst tactor = tokenOrActor.actor ? tokenOrActor.actor : tokenOrActor;\n\tlet commandWord = getProperty(tactor.data.flags, \"midi-qol.commandWord\");\n\tnew Dialog({\n\t\ttitle: \"Command\",\n\t\tcontent: `\n\t\t<form id=\"command-form\">\n\t\t\t<p>You are magically compelled to ${commandWord}.</p>\n\t\t</form>\n\t\t`,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Ok\",\n\t\t\t},\n\t\t},\n\t\tdefault: \"one\",\n\t\t}).render(true);\n}",
        "folder": null,
        "sort": 0,
        "permission": {
          "default": 0
        },
        "flags": {}
      }
    },
    "scene-packer": {
      "sourceId": "Item.t1qzFvkdO33xdNBU",
      "hash": "fcf65329d4a57bd69697073cd73b1f58725ac05c"
    },
    "exportSource": {
      "world": "dnd5e",
      "system": "dnd5e",
      "coreVersion": "9.280",
      "systemVersion": "1.6.3"
    }
  }
}