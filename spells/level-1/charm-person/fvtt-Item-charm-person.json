{
  "name": "Charm Person",
  "type": "spell",
  "img": "systems/dnd5e/icons/spells/explosion-magenta-2.jpg",
  "data": {
    "description": {
      "value": "<p>You attempt to charm a humanoid you can see within range. It must make a Wisdom saving throw, and does so with advantage if you or your companions are fighting it. If it fails the saving throw, it is @Compendium[dnd5e.rules.Charmed]{charmed} by you until the spell ends or until you or your companions do anything harmful to it. The @Compendium[dnd5e.rules.Charmed]{charmed} creature regards you as a friendly acquaintance. When the spell ends, the creature knows it was @Compendium[dnd5e.rules.Charmed]{charmed} by you.</p>\n<p><em><strong>At Higher Levels.</strong></em> When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st. The creatures must be within 30 feet of each other when you target them.</p>",
      "chat": "",
      "unidentified": ""
    },
    "source": "Basic Rules, Player's Handbook pg 221",
    "activation": {
      "type": "action",
      "cost": 1,
      "condition": "\"@raceOrType\".includes(\"humanoid\")"
    },
    "duration": {
      "value": 1,
      "units": "hour"
    },
    "target": {
      "value": 1,
      "width": null,
      "units": "",
      "type": "creature"
    },
    "range": {
      "value": 30,
      "long": null,
      "units": "ft"
    },
    "uses": {
      "value": null,
      "max": "",
      "per": ""
    },
    "consume": {
      "type": "",
      "target": "",
      "amount": null
    },
    "ability": "",
    "actionType": "save",
    "attackBonus": 0,
    "chatFlavor": "",
    "critical": {
      "threshold": null,
      "damage": ""
    },
    "damage": {
      "parts": [],
      "versatile": ""
    },
    "formula": "",
    "save": {
      "ability": "wis",
      "dc": null,
      "scaling": "spell"
    },
    "level": 1,
    "school": "enc",
    "components": {
      "value": "",
      "vocal": true,
      "somatic": true,
      "material": false,
      "ritual": false,
      "concentration": false
    },
    "materials": {
      "value": "",
      "consumed": false,
      "cost": 0,
      "supply": 0
    },
    "preparation": {
      "mode": "prepared",
      "prepared": false
    },
    "scaling": {
      "mode": "none",
      "formula": ""
    },
    "attunement": 0
  },
  "effects": [
    {
      "label": "Charm Person",
      "icon": "systems/dnd5e/icons/spells/explosion-magenta-2.jpg",
      "changes": [
        {
          "key": "StatusEffect",
          "mode": 0,
          "value": "Convenient Effect: Charmed",
          "priority": "20"
        },
        {
          "key": "flags.charmSource",
          "mode": 0,
          "value": "@actorUuid",
          "priority": "20"
        }
      ],
      "duration": {
        "startTime": null
      },
      "tint": null,
      "transfer": false,
      "disabled": false,
      "flags": {
        "dae": {
          "transfer": false,
          "stackable": "none",
          "selfTarget": false,
          "durationExpression": "",
          "macroRepeat": "none",
          "specialDuration": []
        },
        "ddbimporter": {
          "disabled": false
        },
        "midi-qol": {
          "forceCEOff": true
        },
        "core": {
          "statusId": ""
        },
        "dnd5e-helpers": {
          "rest-effect": "Ignore"
        },
        "ActiveAuras": {
          "isAura": false,
          "aura": "None",
          "radius": null,
          "alignment": "",
          "type": "",
          "ignoreSelf": false,
          "height": false,
          "hidden": false,
          "displayTemp": false,
          "hostile": false,
          "onlyOnce": false
        }
      },
      "_id": "e19yq2k1kc7n18qy",
      "selectedKey": [
        "StatusEffect",
        "__"
      ]
    }
  ],
  "flags": {
    "ddbimporter": {
      "id": 136194,
      "definitionId": 2025,
      "entityTypeId": 435869154,
      "dndbeyond": {
        "lookup": "generic",
        "lookupName": "generic",
        "level": null,
        "castAtLevel": null
      },
      "originalName": "Charm Person",
      "sources": [
        {
          "sourceId": 1,
          "pageNumber": null,
          "sourceType": 2
        },
        {
          "sourceId": 2,
          "pageNumber": 221,
          "sourceType": 1
        }
      ],
      "tags": [
        "Control",
        "Social"
      ],
      "version": "2.9.64",
      "effectsApplied": true
    },
    "core": {
      "sourceId": "Compendium.world.ddb-spells-2.RHuJwiS78fNWYdQ5"
    },
    "scene-packer": {
      "hash": "7d4cb3fced9937914b039a83ae682bff6f36ff4a",
      "sourceId": "Item.nMLisTVBfyf6ufhG"
    },
    "rest-recovery": {
      "data": {
        "recovery": {
          "enabled": false
        }
      }
    },
    "midi-qol": {
      "effectActivation": true,
      "forceCEOn": false,
      "onUseMacroName": "[preSave]ItemMacro"
    },
    "midiProperties": {
      "nodam": false,
      "fulldam": false,
      "halfdam": false,
      "rollOther": false,
      "critOther": false,
      "magicdam": false,
      "magiceffect": false,
      "concentration": false,
      "toggleEffect": false
    },
    "itemacro": {
      "macro": {
        "data": {
          "_id": null,
          "name": "Charm Person",
          "type": "script",
          "author": "otqBqyqMuTGDffTr",
          "img": "icons/svg/dice-target.svg",
          "scope": "global",
          "command": "// charm person\n\nconst lastArg = args[args.length - 1];\n\nif (args[0].tag == \"OnUse\") {\n\tif (lastArg.targetUuids.length > 0) {\n\t\tlet token = await fromUuid(lastArg.tokenUuid);\n\t\tlet targetToken = await fromUuid(lastArg.targetUuids[0]);\n\t\tlet targetActor = targetToken.actor ?? targetToken._actor;\n\t\tif (game?.combat?.current && targetToken.data.disposition != token.data.disposition && targetToken.data.disposition != \"Neutral\") {\n\t\t\tgame.dfreds.effectInterface.addEffect({ effectName: \"Reaction\", uuid: targetActor.uuid });\n\t\t\tconst effectData = {\n\t\t\t\tchanges: [\n\t\t\t\t\t{\n\t\t\t\t\t\tkey: \"flags.midi-qol.advantage.ability.save.all\",\n\t\t\t\t\t\tmode: CONST.ACTIVE_EFFECT_MODES.CUSTOM,\n\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\tpriority: 20,\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tdisabled: false,\n\t\t\t\tflags: { dae: { specialDuration: [\"isSave\"] } },\n\t\t\t\ticon: args[0].item.img,\n\t\t\t\tlabel: `${args[0].item.name} Save Advantage`,\n\t\t\t};\n\t\t\tawait targetActor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);\n\t\t}\n\t}\n}",
          "folder": null,
          "sort": 0,
          "permission": {
            "default": 0
          },
          "flags": {}
        },
        "_id": null,
        "name": "Charm Person",
        "type": "script",
        "author": "ckiTPzlaPztdkjV6",
        "img": "icons/svg/dice-target.svg",
        "scope": "global",
        "command": "// charm person\n\nconst lastArg = args[args.length - 1];\n\nif (args[0].tag === \"OnUse\") {\n\tif (lastArg.targetUuids.length > 0) {\n\t\tlet token = await fromUuid(lastArg.tokenUuid);\n\t\tlet targetToken = await fromUuid(lastArg.targetUuids[0]);\n\t\tlet targetActor = targetToken.actor ?? targetToken._actor;\n\t\tconst resist = [\"Fey Ancestry\", \"Duergar Reslience\", \"Charm Resilience\"];\n\t\tlet getResist = targetActor.items.find(i => resist.includes(i.name));\n\t\tif ((game?.combat?.current && targetToken.data.disposition != token.data.disposition && targetToken.data.disposition != \"Neutral\") || getResist) {\n\t\t\tconst effectData = {\n\t\t\t\tchanges: [\n\t\t\t\t\t{\n\t\t\t\t\t\tkey: \"flags.midi-qol.advantage.ability.save.all\",\n\t\t\t\t\t\tmode: CONST.ACTIVE_EFFECT_MODES.CUSTOM,\n\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\tpriority: 20,\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tdisabled: false,\n\t\t\t\tflags: { dae: { specialDuration: [\"isSave\"] } },\n\t\t\t\ticon: args[0].item.img,\n\t\t\t\tlabel: `${args[0].item.name} Save Advantage`,\n\t\t\t};\n\t\t\tawait targetActor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);\n\t\t}\n\t}\n}",
        "folder": null,
        "sort": 0,
        "permission": {
          "default": 0
        },
        "flags": {}
      }
    },
    "exportSource": {
      "world": "dnd5e",
      "system": "dnd5e",
      "coreVersion": "9.280",
      "systemVersion": "1.6.3"
    }
  }
}