{
  "name": "Life Drain",
  "type": "weapon",
  "img": "icons/magic/unholy/strike-hand-glow-pink.webp",
  "data": {
    "description": {
      "value": "<section class=\"secret\">\n<section class=\"secret\" style=\"border-top: 1px solid var(--color-border-dark-5); border-bottom: 1px solid var(--color-border-dark-5);\">\n<p><em>Melee Spell Attack:</em><strong>+4 to hit,</strong>&nbsp;<strong>5 ft.,</strong>&nbsp;one creature. Hit:&nbsp;<strong>10 (3d6)&nbsp;<em>necrotic damage</em></strong>.</p>\n<p>The target must succeed on a&nbsp;<strong>DC 10 Constitution</strong>&nbsp;saving throw or its hit point maximum is reduced by an amount equal to the damage taken. This reduction lasts until the creature finishes a long rest. The target dies if this effect reduces its hit point maximum to 0.</p>\n</section>\n</section>",
      "chat": "",
      "unidentified": ""
    },
    "source": "",
    "quantity": 1,
    "weight": 0,
    "price": "0",
    "attunement": 0,
    "equipped": true,
    "rarity": "",
    "identified": true,
    "activation": {
      "type": "action",
      "cost": 1,
      "condition": ""
    },
    "duration": {
      "value": null,
      "units": ""
    },
    "target": {
      "value": null,
      "width": null,
      "units": "",
      "type": ""
    },
    "range": {
      "value": 5,
      "long": null,
      "units": "ft"
    },
    "uses": {
      "value": 0,
      "max": "0",
      "per": ""
    },
    "consume": {
      "type": "",
      "target": "",
      "amount": null
    },
    "ability": "dex",
    "actionType": "mwak",
    "attackBonus": "0",
    "chatFlavor": "",
    "critical": {
      "threshold": null,
      "damage": ""
    },
    "damage": {
      "parts": [
        [
          "3d6[necrotic]",
          "necrotic"
        ]
      ],
      "versatile": ""
    },
    "formula": "",
    "save": {
      "ability": "con",
      "dc": 10,
      "scaling": "flat"
    },
    "armor": {
      "value": 10
    },
    "hp": {
      "value": 0,
      "max": 0,
      "dt": null,
      "conditions": ""
    },
    "weaponType": "natural",
    "baseItem": "",
    "properties": {
      "amm": false,
      "fin": false,
      "fir": false,
      "foc": false,
      "hvy": false,
      "lgt": false,
      "lod": false,
      "rch": false,
      "rel": false,
      "ret": false,
      "spc": false,
      "thr": false,
      "two": false,
      "ver": false,
      "ada": false,
      "mgc": false,
      "sil": false
    },
    "proficient": true,
    "attuned": false
  },
  "effects": [],
  "flags": {
    "midi-qol": {
      "fumbleThreshold": null,
      "effectActivation": false,
      "onUseMacroName": "[postActiveEffects]ItemMacro"
    },
    "midiProperties": {
      "nodam": false,
      "fulldam": true,
      "halfdam": false,
      "rollOther": false,
      "critOther": false,
      "magicdam": false,
      "magiceffect": false,
      "concentration": false,
      "toggleEffect": false
    },
    "rest-recovery": {
      "data": {
        "recovery": {
          "enabled": false
        }
      }
    },
    "core": {
      "sourceId": "Item.S2ALlsi449yqfkc5"
    },
    "itemacro": {
      "macro": {
        "data": {
          "_id": null,
          "name": "Life Drain",
          "type": "script",
          "author": "otqBqyqMuTGDffTr",
          "img": "icons/svg/dice-target.svg",
          "scope": "global",
          "command": "// life drain\n\nif (args[0].hitTargets.length < 1 || ![\"mwak\"].includes(args[0].itemData.data.actionType)) return;\nif (args[0].failedSaves.length < 1) return;\ntoken = canvas.tokens.get(args[0].tokenId);\nactor = token.actor;\nif (!actor || !token) return;\nlet target = canvas.tokens.get(args[0].targets[0].id ?? args[0].targets[0]._id);\nif (!target) return;\nlet targetActor = target.actor ?? target._actor;\n\nconst necroticTotal = args[0].damageTotal;\nconst necroticRes = (targetActor.data.data.traits.di?.value).includes(\"necrotic\") ? 0 : (targetActor.data.data.traits.dr?.value).includes(\"necrotic\") ? 0.5 : 1;\nconst necroticVul = (targetActor.data.data.traits.dv?.value).includes(\"necrotic\") ? 2 : 1;\nconst necroticFinal = Math.floor(necroticTotal * necroticRes) * necroticVul;\n\nif (necroticFinal > 0) {\n\tconst effectData = {\n\t\t\tchanges: [\n\t\t\t\t{\n\t\t\t\t\tkey: \"data.attributes.hp.max\",\n\t\t\t\t\tmode: CONST.ACTIVE_EFFECT_MODES.ADD,\n\t\t\t\t\tvalue: -necroticFinal,\n\t\t\t\t\tpriority: 20,\n\t\t\t\t}\n\t\t\t],\n\t\t\tdisabled: false,\n\t\t\tflags: { dae: { specialDuration: [\"longRest\"] } },\n\t\t\ticon: args[0].item.img,\n\t\t\tlabel: `${args[0].item.name} Affliction`,\n\t};\n\tawait targetActor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);\n};",
          "folder": null,
          "sort": 0,
          "permission": {
            "default": 0
          },
          "flags": {}
        }
      }
    },
    "scene-packer": {
      "sourceId": "Item.w1Acm8KgOdz12ugx",
      "hash": "9d5610b3ac5b0a0f04f58097dd55cf6c08bad876"
    },
    "exportSource": {
      "world": "dnd5e",
      "system": "dnd5e",
      "coreVersion": "9.280",
      "systemVersion": "1.6.3"
    }
  }
}