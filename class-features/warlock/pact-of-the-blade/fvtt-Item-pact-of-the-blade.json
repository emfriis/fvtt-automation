{
  "name": "Pact of the Blade",
  "type": "feat",
  "img": "icons/skills/melee/weapons-crossed-swords-teal.webp",
  "data": {
    "description": {
      "value": "<p>You can use your action to create a pact weapon in your empty hand. You can choose the form that this melee weapon takes each time you create it. You are proficient with it while you wield it. This weapon counts as magical for the purpose of overcoming resistance and immunity to nonmagical attacks and damage.</p><p>Your pact weapon disappears if it is more than 5 feet away from you for 1 minute or more. It also disappears if you use this feature again, if you dismiss the weapon (no action required), or if you die.</p><p>You can transform one magic weapon into your pact weapon by performing a special ritual while you hold the weapon. You perform the ritual over the course of 1 hour, which can be done during a short rest. You can then dismiss the weapon, shunting it into an extradimensional space, and it appears whenever you create your pact weapon thereafter. You can't affect an artifact or a sentient weapon in this way. The weapon ceases being your pact weapon if you die, if you perform the 1-hour ritual on a different weapon, or if you use a 1-hour ritual to break your bond to it. The weapon appears at your feet if it is in the extradimensional space when the bond breaks.</p>",
      "chat": "",
      "unidentified": ""
    },
    "source": "PHB pg. 107",
    "activation": {
      "type": "action",
      "cost": 1,
      "condition": ""
    },
    "duration": {
      "value": null,
      "units": ""
    },
    "target": {
      "value": null,
      "width": null,
      "units": "",
      "type": "self"
    },
    "range": {
      "value": null,
      "long": null,
      "units": "self"
    },
    "uses": {
      "value": null,
      "max": "",
      "per": ""
    },
    "consume": {
      "type": "",
      "target": "",
      "amount": null
    },
    "ability": "",
    "actionType": "util",
    "attackBonus": 0,
    "chatFlavor": "",
    "critical": {
      "threshold": null,
      "damage": ""
    },
    "damage": {
      "parts": [],
      "versatile": ""
    },
    "formula": "",
    "save": {
      "ability": "",
      "dc": null,
      "scaling": "spell"
    },
    "requirements": "Warlock 3",
    "recharge": {
      "value": null,
      "charged": false
    }
  },
  "effects": [
    {
      "_id": "XNuaDayMdXcQo4Ie",
      "changes": [
        {
          "key": "macro.itemMacro",
          "mode": 0,
          "value": "",
          "priority": "20"
        }
      ],
      "disabled": false,
      "duration": {
        "startTime": null
      },
      "icon": "icons/skills/melee/weapons-crossed-swords-teal.webp",
      "label": "Pact Weapon",
      "origin": "Item.YzhsVimjATbHBR1k",
      "transfer": false,
      "flags": {
        "dae": {
          "selfTarget": false,
          "stackable": "none",
          "durationExpression": "",
          "macroRepeat": "none",
          "specialDuration": [],
          "transfer": false
        },
        "core": {
          "statusId": ""
        },
        "dnd5e-helpers": {
          "rest-effect": "Ignore"
        },
        "ActiveAuras": {
          "isAura": false,
          "aura": "None",
          "radius": null,
          "alignment": "",
          "type": "",
          "ignoreSelf": false,
          "height": false,
          "hidden": false,
          "displayTemp": false,
          "hostile": false,
          "onlyOnce": false
        }
      },
      "tint": null,
      "selectedKey": "macro.itemMacro"
    }
  ],
  "flags": {
    "core": {
      "sourceId": "Compendium.dnd5e.classfeatures.9dSSa68mIPoX2ezA"
    },
    "rest-recovery": {
      "data": {
        "recovery": {
          "enabled": false
        }
      }
    },
    "itemacro": {
      "macro": {
        "data": {
          "_id": null,
          "name": "Pact of the Blade",
          "type": "script",
          "author": "otqBqyqMuTGDffTr",
          "img": "icons/svg/dice-target.svg",
          "scope": "global",
          "command": "const lastArg = args[args.length - 1];\nconst tokenOrActor = await fromUuid(lastArg.actorUuid);\nconst targetActor = tokenOrActor.actor ? tokenOrActor.actor : tokenOrActor;\nconst DAEItem = lastArg.efData.flags.dae.itemData;\n\nlet hexWarrior = targetActor.items.find(i => i.name === \"Hex Warrior\");\nlet improved = targetActor.items.find(i => i.name === \"Eldritch Invocations: Improved Pact Weapon\");\n\nfunction valueLimit(val, min, max) {\n  return val < min ? min : val > max ? max : val;\n}\n\n/**\n * Select for weapon\n */\nif (args[0] === \"on\") {\n  const folderName = \"Weapons\";\n  const getFolder = game.folders.getName(folderName).content;\n  let weapons;\n  if (!improved) {\n    weapons = getFolder.filter((i) => i.data.type === \"weapon\" && i.data.data.actionType === \"mwak\");\n  } else if (improved) {\n    weapons = getFolder.filter((i) => i.data.type === \"weapon\");\n  }\n  const weaponContents = weapons.reduce((acc, target) => acc += `<option value=\"${target.id}\">${target.name}</option>`\n    , ``);\n  const content = `<p>Pick a weapon</p><form><div class=\"form-group\"><label for=\"weapon\">Weapon:</label><select id=\"weapon\">${weaponContents}</select></div></form>`;\n\n  new Dialog({\n    content,\n    buttons: {\n      ok: {\n        label: `Ok`,\n        callback: (html) => {\n          let itemId = html.find('#weapon')[0].value;\n\t\t  let weaponItem = getFolder.find(i => i.id === itemId);\n          let copyItem = duplicate(weaponItem);\n          DAE.setFlag(targetActor, \"pactWeapon\", {\n\t\t\tname: \"Pact \"+copyItem.name,\n          });\n          if (copyItem.data.attackBonus === \"\") copyItem.data.attackBonus = \"0\";\n\t\t  if (copyItem.data.attackBonus === \"0\" && improved) {\n\t\t\tcopyItem.data.attackBonus += 1;\n\t\t\tcopyItem.data.damage.parts[0][0] += \" + 1\"\n\t\t\tif (copyItem.data.damage.versatile !== \"\" && copyItem.data.damage.versatile !== null) copyItem.data.damage.versatile += \" + 1\";\n\t\t  }\n          if (hexWarrior) copyItem.data.ability = \"cha\";\n\t\t  copyItem.name = \"Pact \" + copyItem.name;\n\t\t  copyItem.data.equipped = true;\n\t\t  copyItem.data.properties.proficient = true;\n          targetActor.createEmbeddedDocuments(\"Item\", [copyItem]);\n        },\n      },\n      cancel: {\n        label: `Cancel`,\n      },\n    },\n  }).render(true);\n}\n\n//Delete weapon and unset flag.\nif (args[0] === \"off\") {\n  const { name } = DAE.getFlag(targetActor, \"pactWeapon\");\n  let weapon = targetActor.items.find(i => i.name === name);\n  targetActor.deleteEmbeddedDocuments(\"Item\", [weapon._id ?? weapon.id]);\n}",
          "folder": null,
          "sort": 0,
          "permission": {
            "default": 0
          },
          "flags": {}
        }
      }
    },
    "midi-qol": {
      "effectActivation": false
    },
    "midiProperties": {
      "nodam": false,
      "fulldam": false,
      "halfdam": false,
      "rollOther": false,
      "critOther": false,
      "magicdam": false,
      "magiceffect": false,
      "concentration": false,
      "toggleEffect": false
    },
    "scene-packer": {
      "sourceId": "Item.YzhsVimjATbHBR1k"
    },
    "exportSource": {
      "world": "Curse of Strahd",
      "system": "dnd5e",
      "coreVersion": "9.280",
      "systemVersion": "1.6.3"
    }
  }
}